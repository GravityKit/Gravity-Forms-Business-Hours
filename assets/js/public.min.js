!function($){"use strict";var self=$.extend({lists:[],days:[GFBusinessHours.day_1,GFBusinessHours.day_2,GFBusinessHours.day_3,GFBusinessHours.day_4,GFBusinessHours.day_5,GFBusinessHours.day_6,GFBusinessHours.day_7],business_hours_list:[]});self.init=function(){self.build_dropdowns(),self.build_lists(),self.setup_bindings(),$(".item_fromtime").trigger("change")},self.setup_bindings=function(){$(document).on("click",".business_hours_remove_button",self.click_remove_button),$(document).on("click",".business_hours_add_button",self.click_add_button),$(document).on("change",".item_fromtime",self.time_change)},self.time_change=function(){$(this).parents(".business_hours_item").find('.item_totime option[value="'+$(this).val()+'"]').attr("disabled","disabled").prevAll("option").attr("disabled","disabled")},self.get_list=function(id){return self.lists[id]=self.lists[id]||[]},self.click_add_button=function(e){e.preventDefault();var field_id=$(this).parents(".business_hours_item").attr("rel"),$parent=$(this).parents(".business_hours_item"),item={day:$parent.find(".item_day").val(),fromtime:$parent.find(".item_fromtime").val(),totime:$parent.find(".item_totime").val()};return self.business_hours_list=self.get_list(field_id),self.does_exact_day_exist(item,self.business_hours_list)?(alert(GFBusinessHours.already_exists),!1):(self.business_hours_list.push(item),self.update_input_value(this),self.populate_business_hours_list(this),self.move_day_forward($parent,item),void 0)},self.move_day_forward=function($parent,item){var $day_field=$parent.find(".item_day"),day_index=self.days.indexOf(item.day);6===day_index?day_index=0:day_index++,$day_field.val(self.days[day_index])},self.click_remove_button=function(e){e.preventDefault();var field_id=$(this).parents(".business_hours_item").attr("rel"),index=$(this).parents(".business_hours_list_item").index(),list_string_value=self.get_list(field_id);self.business_hours_list=list_string_value,index>=0&&(self.business_hours_list.splice(index,1),self.update_input_value(this),$(this).parents(".business_hours_list_item").remove())},self.get_times_array=function(with_after_midnight){for(var times=["12:00 "+GFBusinessHours.am+" "+GFBusinessHours.midnight,"12:30 "+GFBusinessHours.am],i=1;12>i;i++)times.push(i+":00 "+GFBusinessHours.am),times.push(i+":30 "+GFBusinessHours.am);times.push("12:00 "+GFBusinessHours.pm+" "+GFBusinessHours.noon),times.push("12:30 "+GFBusinessHours.pm);for(var i=1;12>i;i++)times.push(i+":00 "+GFBusinessHours.pm),times.push(i+":30 "+GFBusinessHours.pm);if(!0===with_after_midnight){times.push("12:00 "+GFBusinessHours.am+" ("+GFBusinessHours.midnight+" "+GFBusinessHours.nextDay+")"),times.push("12:30 "+GFBusinessHours.am+" ("+GFBusinessHours.nextDay+")");for(var i=1;7>i;i++)times.push(i+":00 "+GFBusinessHours.am+" ("+GFBusinessHours.nextDay+")"),times.push(i+":30 "+GFBusinessHours.am+" ("+GFBusinessHours.nextDay+")")}return times},self.get_days_select=function(){var output=[];for(var i in self.days)output.push('<option value="'+self.days[i]+'">'+self.days[i]+"</option>");return output.join("")},self.get_times_select=function(with_after_midnight){var output_times=self.get_times_array(with_after_midnight),output=[];for(var i in output_times)output.push('<option value="'+output_times[i]+'">'+output_times[i]+"</option>");return output.join("")},self.build_dropdowns=function(){$(".business_hours_item").each(function(){$(this).find(".item_fromtime,.item_totime,.item_day").empty(),$(this).find(".item_day").append(self.get_days_select),$(this).find(".item_fromtime").append(self.get_times_select(!1)),$(this).find(".item_totime").append(self.get_times_select(!0)),$(".item_fromtime").val("9:00 "+GFBusinessHours.am),$(".item_totime").val("5:00 "+GFBusinessHours.pm)})},self.build_lists=function(){$(".business_hours_list_item").each(function(){var $item=$(this).parents(".business_hours_item:first"),field_id=$item.attr("rel"),value=$item.find("input:first").val();self.lists[field_id]=$.parseJSON(value)})},self.populate_business_hours_list=function(obj){var $container=jQuery(obj).parents(".business_hours_item").find(".business_hours_list");$container.empty();var items=[];for(var i in self.business_hours_list)items.push('<div class="business_hours_list_item"><strong>'+self.business_hours_list[i].day+"</strong>  <span>"+self.business_hours_list[i].fromtime+"</span> - <span>"+self.business_hours_list[i].totime+'</span><a href="#" class="business_hours_remove_button"><i class="dashicons dashicons-dismiss"></i></a></div>');$container.append(items.join(""))},self.update_input_value=function(obj){var json_string=JSON.stringify(self.business_hours_list);$(obj).parents(".business_hours_item").find("input:first").val(json_string)},self.does_exact_day_exist=function(obj,list){var i;for(i=0;i<list.length;i++)if(list[i].day===obj.day&&list[i].fromtime===obj.fromtime&&list[i].totime===obj.totime)return!0;return!1},$(self.init)}(jQuery);